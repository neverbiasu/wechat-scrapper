# 认证模块

## 功能描述

认证模块为用户提供了管理和使用微信公众平台认证信息的功能。通过本模块，用户可以设置、保存和更新认证凭据，处理验证请求，以便顺利访问微信公众号文章。

### 认证信息管理

本模块允许用户：
- 设置微信公众平台的cookie和token
- 从配置文件加载认证信息
- 保存认证信息到配置文件
- 验证认证信息的有效性

### 验证流程处理

当爬取过程中触发微信平台的验证机制时，本模块提供：
- 自动检测需要验证的情况
- 引导用户完成验证步骤
- 自动打开验证页面（如可能）
- 明确的验证完成后的操作指南

## 使用指南

### 设置认证信息

您需要提供微信公众平台的cookie和token才能使用本工具。这些信息可以通过以下步骤获取：

1. 使用Chrome浏览器登录微信公众平台(https://mp.weixin.qq.com/)
2. 按F12打开开发者工具
3. 切换到Network标签页
4. 刷新页面
5. 在请求列表中找到一个主页请求
6. 在请求的Headers标签页中找到Cookie字段，复制其值
7. 访问任一文章，并在请求参数中找到appmsg_token值

获取后，可以通过命令行参数设置：

```bash
wechat-scrapper download --url "文章URL" --cookie "您的cookie" --token "您的token"
```

或通过配置文件设置：

```json
{
  "cookie": "您的cookie值",
  "token": "您的token值"
}
```

然后使用：

```bash
wechat-scrapper download --url "文章URL" --config config.json
```

### 处理验证请求

当您看到"当前环境异常，请完成验证"的提示时：

1. 工具会尝试自动在浏览器中打开验证页面
2. 使用微信扫描显示的二维码完成验证
3. 验证成功后，重新获取cookie（步骤同上）
4. 使用新cookie重新运行命令

## 最佳实践

1. **定期更新认证信息**：cookie和token通常会在几小时到几天内过期
2. **使用配置文件**：将认证信息保存在配置文件中，避免每次手动输入
3. **注意信息安全**：不要在公共环境或共享代码时暴露您的认证信息
4. **验证后立即使用**：完成验证后尽快使用新的认证信息，避免再次过期
